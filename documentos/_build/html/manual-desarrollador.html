<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Manual para el Desarrollador &mdash; Manual del Desarrollador para Canaima GNU/Linux</title>
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.0+0',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/translations.js"></script>
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="top" title="Manual del Desarrollador para Canaima GNU/Linux" href="index.html" />
    <link rel="next" title="Guía de Referencia para el Desarrollador" href="guia-referencia.html" />
    <link rel="prev" title="CANAIMA-DESARROLLADOR" href="man-canaima-desarrollador.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navegación</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="Índice General"
             accesskey="I">índice</a></li>
        <li class="right" >
          <a href="guia-referencia.html" title="Guía de Referencia para el Desarrollador"
             accesskey="N">siguiente</a> |</li>
        <li class="right" >
          <a href="man-canaima-desarrollador.html" title="CANAIMA-DESARROLLADOR"
             accesskey="P">anterior</a> |</li>
        <li><a href="index.html">Manual del Desarrollador para Canaima GNU/Linux</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="manual-para-el-desarrollador">
<h1><strong>Manual para el Desarrollador</strong><a class="headerlink" href="#manual-para-el-desarrollador" title="Enlazar permanentemente con este título">¶</a></h1>
<p>Es bien sabido que Canaima GNU/Linux es una de las distribuciones de Software Libre más importantes de Venezuela. Actualmente se incluye en más de 880 mil portátiles del proyecto Canaima Educativo, ha sido descargado más de 120 mil veces del portal oficial y se planea extender el Proyecto a toda la Administración Pública Nacional.</p>
<p>Sin embargo, la popularidad no lo es todo. Detrás de Canaima GNU/Linux existe un ciclo de desarrollo bastante particular, propio de la dinámica socio-tecnológica en que está envuelto. Éste documento describirá la metodología mediante la cual el colectivo asociado a la Metadistribución, participa en los procesos socio-productivos y de desarrollo que impulsan la generación de Nuevas versiones de Canaima y sustentan su plataforma tecnológica.</p>
<div class="section" id="sobre-el-ciclo-de-desarrollo-de-canaima">
<h2><strong>Sobre el Ciclo de Desarrollo de Canaima</strong><a class="headerlink" href="#sobre-el-ciclo-de-desarrollo-de-canaima" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Podemos decir que básicamente el ciclo de desarrollo de Canaima sigue un flujo natural de los acontecimientos tal cual se reseñan en el esquema inferior.</p>
<img alt="_images/diagrama.png" src="_images/diagrama.png" style="width: 1000px;" />
<div class="section" id="quienes-son-los-actores">
<h3>¿Quienes son los actores?<a class="headerlink" href="#quienes-son-los-actores" title="Enlazar permanentemente con este título">¶</a></h3>
<p>La comunidad canaima está conformada por un gran número de personas que tienen intereses comunes y que comparten un mismo espacio virtual conformado por una serie de herramientas y servicios condensados en una plataforma pública. Éstos actores provienen de distintas organizaciones y colectivos, a saber: el <a class="reference external" href="http://www.cnti.gob.ve/">CNTI</a>, Instituciones Públicas en general, Unidades Productivas, Cooperativas, Empresas Privadas, Activistas Sociales y Usuarios en general.</p>
<p>Éste conjunto de personas poseen una dinámica propia, característica de sus realidades particulares; sin embargo, es posible diferenciar un ciclo que se ejecuta cada vez que se publica una nueva versión de Canaima GNU/Linux.</p>
</div>
<div class="section" id="cocinando-una-nueva-version-de-canaima-gnu-linux">
<h3>Cocinando una nueva versión de Canaima GNU/Linux<a class="headerlink" href="#cocinando-una-nueva-version-de-canaima-gnu-linux" title="Enlazar permanentemente con este título">¶</a></h3>
<p>En teoría, una versión de Canaima es publicada cada ~6 meses en sincronía con la <a class="reference external" href="http://cayapa.canaima.softwarelibre.gob.ve/">Cayapa</a>. Para que ésto se cumpla, ciertos hitos deben ser alcanzados.</p>
<p><strong>La primera meta es realizar un producto</strong>. ¿Quien puede realizar un producto para Canaima GNU/Linux? Cualquiera puede hacerlo, sin embargo te recomendamos ciertas cosas que te ayudarán a hacerlo con mayor calidad y eficiencia:</p>
<ul class="simple">
<li>Aprende a empaquetar con git-buildpackage (más abajo).</li>
<li>Participa en la lista de correo <a class="reference external" href="http://listas.canaima.softwarelibre.gob.ve/cgi-bin/mailman/listinfo/desarrolladores">desarrolladores</a>, <a class="reference external" href="http://listas.canaima.softwarelibre.gob.ve/cgi-bin/mailman/listinfo/discusion">discusion</a> y <a class="reference external" href="http://listas.canaima.softwarelibre.gob.ve/cgi-bin/mailman/listinfo/soporte">soporte</a>.</li>
<li>Usa Canaima para todo.</li>
<li>Infórmate acerca de las conclusiones a las que se llegaron en la última Cayapa.</li>
</ul>
<p><strong>¿Que producto hago?</strong> Existen dos formas de actuar en éste dilema: <strong>determinar y seleccionar una necesidad actual del Proyecto Canaima</strong>, a través de los medios de comunicación destinados a ello (<a class="reference external" href="http://listas.canaima.softwarelibre.gob.ve/cgi-bin/mailman/listinfo">Listas de Correo</a>, <a class="reference external" href="http://proyectos.canaima.softwarelibre.gob.ve/canaima/query">Sistema de Reporte de Bugs</a>, <a class="reference external" href="http://canaima.softwarelibre.gob.ve/soporte/soporte/chat-irc">Chat IRC</a>, <a class="reference external" href="http://cayapa.canaima.softwarelibre.gob.ve/">Cayapa</a> y otros eventos sociales) o <strong>seleccionar un proyecto de iniciativa propia</strong>. Una vez concretado el producto que vas a hacer, cómo lo vas a hacer y en que tiempo, anúncialo, comunícalo a la comunidad y ¡Manos a la obra!</p>
<p>Es importante añadir tu proyecto en el <a class="reference external" href="http://canaima.softwarelibre.gob.ve/descargas/canaima-dvdnvivo/mapa-de-ruta">Mapa de ruta de la próxima versión de Canaima</a>.</p>
</div>
<div class="section" id="etapas-de-desarrollo">
<h3>Etapas de Desarrollo<a class="headerlink" href="#etapas-de-desarrollo" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Las etapas de desarrollo iniciales de un producto son locales e involucran casi cualquier elemento que al desarrollador se le ocurra, en fin, es producto de un proceso creativo que se parece mucho a un proceso artístico. Cuando tu proyecto tenga una estructura más o menos definida, es hora de versionarlo con git e ir publicando tu código; en ésta etapa entra en juego <a class="reference external" href="http://forja.softwarelibre.gob.ve/">forja.softwarelibre.gob.ve</a>.</p>
<p>“La forja” es un espacio público donde puedes alojar proyectos de software libre de una forma práctica y gratuita, bajo la plataforma de Canaima GNU/Linux y usando un repositorio git. Crea un proyecto y ve publicando tu código ahí.</p>
<p>A medida que vas madurando y depurando tu código, es buena idea ir también trabajando en la debianización del paquete fuente para finalmente generar el paquete binario con git-buildpackage.  Haz sucesivas pruebas de empaquetado con tu proyecto, y cuando llegues a un nivel en donde sea usable, puedes solicitar a través de la lista de correo <a class="reference external" href="http://listas.canaima.softwarelibre.gob.ve/cgi-bin/mailman/listinfo/desarrolladores">desarrolladores</a> permisos suficientes en los servidores de la Plataforma Canaima para subir tus paquetes a la rama de desarrollo. En tu solicitud debes incluir:</p>
<blockquote>
<ol class="arabic simple">
<li>Nombre del Paquete (Completo).</li>
<li>Descripción de su utilidad.</li>
<li>Dependencias con otros paquetes.</li>
<li>Dirección del código fuente.</li>
<li>Direccción del paquete .deb tal cual va a ser incluído en los repositorios.</li>
</ol>
</blockquote>
<p>Una vez otorgados los permisos, puedes subir cuantas versiones consideres, con la frecuencia que necesites. Está demás decir que cualquier intento de violar la privacidad del usuario o de inyectar código malicioso resultará en una severa penalización.</p>
<p>Cuando sientas que haz llegado a una versión estable de tu paquete, es hora de incluirlo en la rama pruebas, para que el colectivo lo use y ofrezca su retroalimentación. El procedimiento es similar al anterior, realiza la petición de inclusión del paquete en la rama pruebas incluyendo la siguiente información:</p>
<blockquote>
<ol class="arabic simple">
<li>Nombre del Paquete (Completo).</li>
<li>Descripción de su utilidad.</li>
<li>Dependencias con otros paquetes.</li>
<li>Dirección del código fuente.</li>
<li>Direccción del paquete .deb tal cual va a ser incluído en los repositorios.</li>
</ol>
</blockquote>
<p>Finalmente, cuando todos los objetivos establecidos en el mapa de ruta se hayan cumplido, todos los paquetes de la rama pruebas serán pasados a estable, generando así una nueva versión de Canaima. Los medios vivos instalables serán generados a través de canaima-semilla.</p>
</div>
</div>
<div class="section" id="versionando-con-git">
<h2><strong>Versionando con GIT</strong><a class="headerlink" href="#versionando-con-git" title="Enlazar permanentemente con este título">¶</a></h2>
<p>GIT es una herramienta de desarrollo muy útil. Con ella cualquier persona podrá manejar de una manera sencilla y práctica el versionamiento de su trabajo.</p>
<div class="section" id="por-que-necesito-versionamiento">
<h3>¿Por qué necesito versionamiento?<a class="headerlink" href="#por-que-necesito-versionamiento" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Muchas veces pasa que queremos devolver uno o varios cambios en archivos que ya guardamos y cerramos y nos encontramos con que no tenemos forma de hacerlo.</p>
<p>Con el control de versiones o versionamiento, tenemos la facilidad de gestionar los diferentes cambios que se hacen en el contenido, configuración y propiedades de los archivos de un determinado proyecto. Ésta característica nos permite devolver cambios hacia versiones anteriores, además de facilitar el acceso y distribución de código fuente mediante la utilización de repositorios locales o remotos.</p>
</div>
<div class="section" id="y-por-que-git">
<h3>¿Y por qué GIT?<a class="headerlink" href="#y-por-que-git" title="Enlazar permanentemente con este título">¶</a></h3>
<p>GIT es una herramienta de versionamiento creada por Linus Torvalds, desarrollador del Kernel Linux. Entre sus beneficios con respecto a otros sistemas de versionamiento tenemos que es un sistema distribuido que permite el trabajo con repositorios locales que luego pueden ser fusionados con el repositorio principal.</p>
</div>
<div class="section" id="como-uso-git">
<h3>¿Cómo uso GIT?<a class="headerlink" href="#como-uso-git" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Lo primero que se debe hacer es instalarlo. Es muy fácil, -como es de costumbre en Linux-, escribimos lo siguiente en una consola con permisos de superusuario:</p>
<div class="highlight-python"><pre>aptitude install git-core</pre>
</div>
<p>Para comenzar a trabajar, accedemos al directorio principal de nuestro proyecto y ejecutamos los siguientes comandos:</p>
<div class="highlight-python"><pre>git init</pre>
</div>
<p>Con ésto inicializamos el versionamiento en el directorio raíz del proyecto:</p>
<div class="highlight-python"><pre>git add .</pre>
</div>
<p>Añadimos todos los archivos del proyecto a ser versionados a nuestro repositorio local:</p>
<div class="highlight-python"><pre>git commit -a -m "Mensaje descriptivo de los cambios"</pre>
</div>
<p>Realizamos la carga de la primera versión de nuestro proyecto.</p>
</div>
<div class="section" id="uso-de-un-repositorio-en-linea">
<h3>Uso de un repositorio en línea<a class="headerlink" href="#uso-de-un-repositorio-en-linea" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Existen varios lugares en internet que brindan servicio gratuito para almacenar proyectos de Software Libre bajo la plataforma GIT. Éstos sitios proveen un repositorio dinámico que permite un versionamiento descentralizado, es decir, que varias personas podrían hacer carga y descarga de datos en nuestro proyecto mediante permisología definida y fusión inteligente, facilitando así el trabajo colaborativo entre diferentes personas.</p>
<p>Uno de éstos sitios es <a class="reference external" href="http://gitorious.com/">Gitorious</a> (también está <a class="reference external" href="http://github.com/">Github</a>). Para poder hacer uso de los servicios de Gitorious (o Github), es necesario que tanto el creador del Proyecto como sus colaboradores se registren. Además, cada cuenta creada debe asignarsele la (o las) llave(s) SSH de los equipos autorizados para publicar o descargar contenido. Para conocer nuestra llave SSH utilizamos el comando ssh-keygen; el resultado de ésta consulta debe ser ingresado en el apartado “Manage SSH Keys”, de la página de tu perfil en gitorious.org.</p>
</div>
<div class="section" id="comenzando-a-trabajar">
<h3>Comenzando a trabajar<a class="headerlink" href="#comenzando-a-trabajar" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Inicialmente, debemos agregar el repositorio remoto, que para el caso de gitorious, se indica en la página principal del proyecto. Para ello, creamos un alias o nombre para la dirección del repositorio, de la siguiente forma:</p>
<div class="highlight-python"><pre>git remote add &lt;alias&gt; &lt;dirección&gt;</pre>
</div>
<p>Por ejemplo:</p>
<div class="highlight-python"><pre>git remote add origin git@gitorious.org:miproyecto/mainline.git</pre>
</div>
<p>Seguidamente, el comando para ejecutar la carga de archivos versionados al servidor es el siguiente (recordar hacer git commit -a antes):</p>
<div class="highlight-python"><pre>git push &lt;alias&gt; &lt;rama&gt;</pre>
</div>
<p>En donde rama indica la rama del ciclo de desarrollo al que pertenece esta carga de archivos. La principal es master. Por ejemplo:</p>
<div class="highlight-python"><pre>git push origin master</pre>
</div>
</div>
<div class="section" id="programacion-colaborativa">
<h3>Programación Colaborativa<a class="headerlink" href="#programacion-colaborativa" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Otras personas pueden bajar los archivos fuente “clonando” tu repositorio. Para hacerlo creamos una carpeta, digamos “proyecto” y dentro de ella ejecutamos:</p>
<div class="highlight-python"><pre>git clone &lt;dirección&gt;</pre>
</div>
<p>Por ejemplo:</p>
<div class="highlight-python"><pre>git clone http://git.gitorious.org/miproyecto/mainline.git</pre>
</div>
<p>Esto descargará los archivos de la rama principal (master) a la carpeta donde nos encontremos. Una vez en poder de los archivos fuente, podremos realizar modificaciones y subirlos al repositorio en línea con el comando git push, descrito anteriormente (siempre y cuando tengamos la permisología necesaria del creador en gitorious.org). Ésta actividad podemos repetirla cuantas veces sea necesario.</p>
<p>Es recomendable actualizar los archivos fuente cada vez que se vayan a realizar cambios para evitar discordancias.</p>
</div>
</div>
<div class="section" id="empaquetando-con-git-buildpackage">
<h2><strong>Empaquetando con git-buildpackage</strong><a class="headerlink" href="#empaquetando-con-git-buildpackage" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Ésta metodología involucra, como eje fundamental, el sistema de versionamiento git fusionado con la metodología de empaquetamiento debian debhelper, permitiéndole al desarrollador mantener el flujo de trabajo estándar en proyectos de Software Libre, usando una sola herramienta. Si necesitas mayor detalle en la descripción de los procesos, puedes consultar la <a class="reference external" href="http://wiki.canaima.softwarelibre.gob.ve/wiki/Guía_de_Referencia_para_el_Desarrollador">Guía de referencia del Desarrollador</a>.</p>
<img alt="_images/diagrama2.png" src="_images/diagrama2.png" style="width: 1000px;" />
<div class="section" id="terminos-fundamentales">
<h3>Términos Fundamentales<a class="headerlink" href="#terminos-fundamentales" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Para comenzar, primero debemos revisar algunos conceptos que nos ayudarán a desenvolvernos mejor en el ambiente de desarrollo que necesitaremos. Éstos términos serán descritos de forma que cualquiera lo pueda entender, puesto que es la introducción de éste post y a medida que vayas leyendo, el nivel de dificultad irá aumentando. Sin embargo, sólo se escribirá lo necesario para que empaquetes, es decir, nada faltará ni nada sobrará.</p>
<hr class="docutils" />
<p>Un <strong>Paquete Fuente</strong> (comúnmente de extensión .tar.gz) es un paquete comprimido que contiene los archivos fuente de un determinado software. Éstos pueden ser por sí mismos los archivos ejecutables (binarios, scripts, entre otros) o, pueden ser los archivos a través de los cuales se generan los ejecutables mediante de un proceso de compilación que depende directamente del lenguaje en que está escrito el software. Para que éstos archivos ejecutables (y demás archivos de contenido y configuración) sean reconocidos por el Sistema de Gestión de Paquetes de Debian, y gocen del beneficio que esto representa (tanto para el desarrollador como para el Sistema operativo), éstos deben ser agrupados y distribuidos a los usuarios en paquetes binarios (.deb).</p>
<p>Por otra parte, los paquetes fuente (adaptados a Debian GNU/Linux) contienen una carpeta llamada “debian” (nótese las minúsculas), en donde se encuentran diferentes archivos que contienen toda la información necesaria para generar el paquete binario a partir del código fuente. Comúnmente la generación de ésta carpeta (proceso al que se le llama “Debianización del Código Fuente”) es la parte más difícil del empaquetamiento, ya que se debe editar manualmente y para ello se debe conocer la estructura del Sistema Operativo (donde va cada tipo de cosa) y la estructura del programa que se desea empaquetar (para qué sirve cada cosa).</p>
<p>Los paquetes fuentes son distribuidos por el desarrollador de la aplicación y por el mantenedor del paquete en las diferentes distribuciones en las que esté disponible.</p>
<hr class="docutils" />
<p>Los <strong>Paquetes Debian</strong> (.deb), también llamados paquetes binarios, son paquetes que contienen software instalable en sistemas operativos Debian y derivados (Ubuntu, Canaima, etc...). Está compuesto por dos partes fundamentales: Archivos de Control y Archivos de Datos.</p>
<p>Los Archivos de Control están agrupados en una carpeta llamada “DEBIAN” (nótese las mayúsculas) y contienen la información necesaria para que el sistema de gestión de paquetes instale (control, md5sum) y configure el paquete (preinst, postinst, prerm, preinst); no debe ser confundido con la carpeta debian de los archivos fuente, la carpeta DEBIAN es generada a partir de la carpeta debian en el proceso de empaquetamiento.</p>
<p>Los Archivos de Datos son los archivos binarios, de texto, configuración y de contenido general propios de la aplicación, dispuestos en la estructura de archivos del sistema tal cual van a ser copiados.</p>
<p>Los paquetes binarios son distribuídos por el mantenedor (o empaquetador) de la aplicación en las diferentes distribuciones en las que esté disponible.</p>
<hr class="docutils" />
<p>Un <strong>Makefile</strong> es un archivo que forma parte de un paquete fuente y que contiene las instrucciones para probar, compilar, instalar, limpiar y desinstalar el software que se distribuye de forma “estática” (no recibe actualizaciones ni se verifican dependencias mediante el sistema de paquetes de Debian). Es generado por el desarrollador del software, quien conoce exactamente como realizar éstas operaciones.</p>
<p>En algunos casos más complejos, se hace necesario hacer un Makefile para distintos propósitos, por lo que se usa otro elemento que a partir de ciertos procedimientos, genera el Makefile automáticamente; éste elemento es el archivo configure. El archivo configure es producido por un set de herramientas desarrolladas por el proyecto GNU denominadas autotools (aunque también puede ser generado manualmente). Puedes encontrar mayor información de cómo generar el makefile para tus aplicaciones aquí, aquí, también aquí y probablemente aquí y aquí (también aquí, aquí, aquí y aquí).</p>
<p>El archivo rules de la carpeta debian es un archivo Makefile, que contiene las operaciones a realizar para generar la estructura de los Archivos de Datos de un paquete binario. Generalmente son operaciones comunes de movimiento de archivos, y creación de carpetas; sin embargo, pueden incluirse operaciones más complejas dependiendo de las necesidades del mantenedor del paquete. Recientemente, y gracias al conjunto de scripts debhelper, no es necesario realizar éstas operaciones “a mano” ya que existen “ayudantes” que detectan qué debe hacerse con cuales archivos a partir de la presencia de ciertas instrucciones en la carpeta debian durante el proceso de empaquetado. Puedes ampliar la información aquí.</p>
<p>Suficientes términos por ahora, manos a la obra!</p>
</div>
<div class="section" id="empezando">
<h3>Empezando<a class="headerlink" href="#empezando" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Para comenzar, necesitaremos varios insumos, uno de ellos es la descripción de nuestro entorno de trabajo. Estamos trabajando en el sistema operativo Canaima, sin embargo, ésta guía también es aplicable a sistemas operativos basados en Debian Lenny (con ligeras diferencias). Usaremos el paquete canaima-semilla para nuestro ejemplo.</p>
<p>Otra cosa que necesitaremos son herramientas de empaquetamiento. A continuación abran una terminal con permisos de Administrador y ejecuten el siguiente comando:</p>
<div class="highlight-python"><pre>aptitude install git-buildpackage build-essential dpkg-dev file libc6-dev patch perl autoconf automake dh-make debhelper devscripts devscripts-el fakeroot gnupg gpc xutils lintian cdbs pbuilder debian-policy developers-reference manpages-es manpages-es-extra debian-reference-es</pre>
</div>
<p>Obteniendo el código fuente</p>
<p>Seguidamente obtengamos el código fuente de la aplicación a empaquetar, cosa que podemos hacer de dos formas:</p>
<p>1.- Clonando el repositorio git con el comando gpb-clone:</p>
<div class="highlight-python"><pre>gbp-clone git@gitorious.org:canaima-gnu-linux/canaima-semilla.git</pre>
</div>
<p>2.- O, generando un repositorio git local a partir de un paquete tar.gz:</p>
<div class="highlight-python"><pre>mkdir canaima-semilla
cd canaima-semilla
git init
git-import-orig canaima-semilla-1.5+3.orig.tar.gz</pre>
</div>
<p>Luego de aplicado alguno de los métodos previos, tendremos una carpeta llamada “canaima-semilla”, conteniendo nuestro código fuente. Es una buena práctica renombar en ésta etapa la carpeta para que cumpla con el siguiente formato: &lt;Paquete&gt;-&lt;Versión&gt;+&lt;Revisión&gt;, para evitarnos problemas más adelante. En el caso de nuestro ejemplo quedaría: canaima-semilla-1.5+3.</p>
<p>Por supuesto, si se está empezando a escribir el programa desde cero, los métodos anteriores no son válidos, ya que ya tendríamos las fuentes en nuestro computador. En ese caso, simplemente posicionate en la carpeta raíz de tu proyecto y haz tu primera versión con git.</p>
</div>
<div class="section" id="debianizando-el-codigo-fuente">
<h3>Debianizando el código fuente<a class="headerlink" href="#debianizando-el-codigo-fuente" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Suponiendo que nuestro paquete no contiene la carpeta debian (generalmente se incluye) o que estamos haciendo un desarrollo nuevo (y no ha sido empaquetado antes), necesitaremos realizar éste trabajo por nosotros mismos mediante el comando dh_make (debhelper). También, aunque ya tengamos la carpeta debian en nuestro código fuente, éste comando nos permite generar automáticamente una copia de las fuentes modificadas con el sufijo .orig, el cual es un elemento que será utilizado como insumo en un proceso posterior del empaquetado.</p>
<p>Como precaución, es recomendable declarar las siguientes variables de entorno antes de ejecutar el comando dh_make, para asegurarnos de identificarnos bien:</p>
<div class="highlight-python"><pre>export DEBFULLNAME="&lt;nombre completo del mantenedor&gt;"
export DEBEMAIL="&lt;correo del mantenedor&gt;"</pre>
</div>
<p>Estando dentro de la carpeta del paquete fuente, ejecutaremos el siguiente comando:</p>
<div class="highlight-python"><pre>dh_make --createorig --cdbs --copyright &lt;licencia&gt; --email &lt;correo&gt;</pre>
</div>
<p>En donde:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">--createorig</span></tt></dt>
<dd>Creará una copia de la carpeta donde se encuentra el código fuente, añadiendo el sufijo .orig. Ésto servirá para regenerar el paquete fuente en etapas posteriores del proceso.</dd>
<dt><tt class="docutils literal"><span class="pre">--cdbs</span></tt></dt>
<dd>Le dirá al proceso que vamos a utilizar el Common Debian Build System, por lo que incluirá algunas plantillas útiles en la carpeta debian.</dd>
<dt><tt class="docutils literal"><span class="pre">--copyright</span></tt></dt>
<dd>Especificará bajo cual licencia publicaremos nuestro software.</dd>
<dt><tt class="docutils literal"><span class="pre">--email</span></tt></dt>
<dd>Identificará el código fuente con nuestro correo.</dd>
</dl>
<p>Para nuestro ejemplo haremos:</p>
<div class="highlight-python"><pre>dh_make --createorig --cdbs --copyright gpl3 --email nombre@correo.com</pre>
</div>
<p>Una vez finalizado el proceso, tendremos unas fuentes debianizadas. Sin embargo, ahora hay que adaptarlas a las necesidades del paquete binario que queremos construir. Examinemos lo que ha puesto dh_make en la carpeta debian por nosotros:</p>
<ul class="simple">
<li>changelog</li>
<li>compat</li>
<li>control</li>
<li>copyright</li>
<li>cron.d.ex</li>
<li>docs</li>
<li>emacsen-install.ex</li>
<li>emacsen-remove.ex</li>
<li>emacsen-startup.ex</li>
<li>init.d.ex</li>
<li>manpage.1.ex</li>
<li>manpage.sgml.ex</li>
<li>manpage.xml.ex</li>
<li>menu.ex</li>
<li>postinst.ex</li>
<li>postrm.ex</li>
<li>preinst.ex</li>
<li>prerm.ex</li>
<li>prueba.cron.d.ex</li>
<li>prueba.default.ex</li>
<li>prueba.doc-base.EX</li>
<li>README.source</li>
<li>README.Debian</li>
<li>rules</li>
<li>source</li>
<li>watch.ex</li>
</ul>
<p>Cada uno de éstos archivos son utilizados por algún ayudante de debhelper para construir el paquete. Su configuración es bastante intuitiva, sin embargo proporcionamos algunos ejemplos:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">debian/control:</th><td class="field-body">Este archivo controla el nombre del paquete fuente, el nombre del paquete binario, en qué sección va el paquete, quién es el responsable (aquí podemos definir también co-responsables), si el paquete reemplaza a otro, sugerir y/o recomendar otras cosas y definir dependencias (tanto en fuentes como en binarios). Más información…</td>
</tr>
<tr class="field"><th class="field-name" colspan="2">debian/changelog:</th></tr>
<tr><td>&nbsp;</td><td class="field-body">En este archivo verás el paquete, la versión+revisión Debian, repositorio y la urgencia, algo como canaima-semilla (1.5+3) desarrollo; urgency=low. Donde 1.5 es la versión del programa, +3 es la revisión de Debian, desarrollo es el repositorio al que deberías subirlo y urgency=low establece cuánto tiempo pasará en paquete en «desarrollo» antes de que se intente migrar a «pruebas» («low» significa 10 días), normalmente usarás el valor «low», aunque «medium» y «high» también están disponibles.</td>
</tr>
<tr class="field"><th class="field-name" colspan="2">debian/copyright:</th></tr>
<tr><td>&nbsp;</td><td class="field-body">En este archivo debes especificar el autor original, el lugar desde el que descargaste el software, y la licencia del programa. Más información…</td>
</tr>
<tr class="field"><th class="field-name">debian/docs:</th><td class="field-body">Este archivo incluye los documentos que se copiarán a /usr/share/doc/paquete cuando se instale. Deben incluirse uno por línea.</td>
</tr>
<tr class="field"><th class="field-name">debian/compat:</th><td class="field-body">Este archivo determina el nivel de compatibilidad con debhelper. Actualmente el nivel recomendado es 7.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="realizar-cambios-al-codigo-fuente">
<h3>Realizar cambios al código fuente<a class="headerlink" href="#realizar-cambios-al-codigo-fuente" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Ésta etapa es bastante flexible y depende en su totalidad de la persona que lo haga. Aquí se harán los cambios que el desarrollador considere de acuerdo con sus objetivos (corregir errores, agregar funcionalidades, entre otros). Usará las herramientas que considere necesarias e incorporará y modificará los archivos que desee sin ningún tipo de restricción, siempre y cuando lo haga dentro de la carpeta de trabajo e incorpore las nuevas reglas (si las hubiera) en los archivos de construcción e instalación del paquete (Makefile, debian/rules, etc..).</p>
</div>
<div class="section" id="versionar-los-cambios">
<h3>Versionar los cambios<a class="headerlink" href="#versionar-los-cambios" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Una vez realizados los cambios, y se considere que son suficientes como para que constituyan una nueva versión de nuestro paquete, es tiempo de versionar el nuevo estado de tu proyecto. Para ello utilizaremos el flujo de trabajo natural de git, que describimos en un post anterior, para luego plasmar los cambios en el archivo debian/changelog mediante el comando git-dch. Éste comando se encargará de recopilar todos los commits nuevos que se han hecho desde la última versión y usará todos sus mensajes para llenar el archivo debian/changelog con una nueva entrada.</p>
<p>Como precaución, es recomendable declarar las siguientes variables de entorno antes de ejecutar el comando git-dch, para asegurarnos de identificarnos bien:</p>
<div class="highlight-python"><pre>export DEBFULLNAME="&lt;nombre completo del mantenedor&gt;"
export DEBEMAIL="&lt;correo del mantenedor&gt;"</pre>
</div>
<p>Ejecutamos en el directorio base, el siguiente comando:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">git</span><span class="o">-</span><span class="n">dch</span> <span class="o">--</span><span class="n">release</span> <span class="o">--</span><span class="n">auto</span> <span class="o">--</span><span class="nb">id</span><span class="o">-</span><span class="n">length</span><span class="o">=</span><span class="mi">7</span> <span class="o">--</span><span class="n">full</span>
</pre></div>
</div>
<p>En donde:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">--release</span></tt></dt>
<dd>Indica que es una nueva versión y que es definitiva (si en cambio usamos –snapshot, se considerará como una versión temporal)</dd>
<dt><tt class="docutils literal"><span class="pre">--auto</span></tt></dt>
<dd>Indica que se adivinará el número de la versión a partir de la entrada anterior.</dd>
<dt><tt class="docutils literal"><span class="pre">--id-length=&quot;N&quot;</span></tt></dt>
<dd>Es el número de caracteres del código del commit que se incluirán.</dd>
<dt><tt class="docutils literal"><span class="pre">--full</span></tt></dt>
<dd>Le indicará que debe incluir todo el mensaje del commit y no un extracto del mismo.</dd>
</dl>
<p>Si por casualidad hemos ejecutado éste comando sin tener commits nuevos, la nueva entrada del debian/changelog será rellenada con la palabra “UNRELEASED”, la cual desaparecerá en el próximo ciclo de versionamiento.</p>
</div>
<div class="section" id="generar-el-paquete-fuente">
<h3>Generar el paquete fuente<a class="headerlink" href="#generar-el-paquete-fuente" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Para generar el paquete fuente, necesitamos añadir los cambios a la rama upstream, la cual es usada como rama “fuente”. Si no está disponible debemos crearla con el comando <strong>git branch upstream</strong>. Para añadir los cambios debemos fusionar la rama master con la upstream de la siguiente forma:</p>
<div class="highlight-python"><pre>git checkout upstream
git merge master
git checkout master</pre>
</div>
<p>El siguiente paso es generar la carpeta .orig.tar.gz que va a ser utilizada para generar el paquete fuente, a través de dh-make:</p>
<div class="highlight-python"><pre>dh_make --createorig --cdbs --copyright &lt;licencia&gt; --email &lt;correo&gt;</pre>
</div>
<p>Seguidamente, creamos el paquete fuente en cuestión, excluyendo el directorio git:</p>
<div class="highlight-python"><pre>cd ..
dpkg-source --format="1.0" -i.git/ -I.git -b canaima-semilla-1.5+3</pre>
</div>
</div>
<div class="section" id="publicar-los-cambios">
<h3>Publicar los cambios<a class="headerlink" href="#publicar-los-cambios" title="Enlazar permanentemente con este título">¶</a></h3>
<p>En ésta etapa, es hora de hacer saber a los demás que existe una nueva versión del código fuente, y la mejor forma de hacerlo es a través de un repositorio público como github o gitorious.</p>
<blockquote>
git push origin master upstream</blockquote>
</div>
<div class="section" id="generar-el-paquete-binario">
<h3>Generar el paquete binario<a class="headerlink" href="#generar-el-paquete-binario" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Finalmente podemos generar nuestro paquete binario. Para ello ejecutamos el siguiente comando:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">git</span><span class="o">-</span><span class="n">buildpackage</span> <span class="o">-</span><span class="n">k</span><span class="o">&lt;</span><span class="n">llave</span><span class="o">&gt;</span> <span class="o">-</span><span class="n">tc</span> <span class="o">--</span><span class="n">git</span><span class="o">-</span><span class="n">tag</span> <span class="o">-</span><span class="n">jN</span>
</pre></div>
</div>
<p>En donde:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">-k&lt;llave&gt;</span></tt></dt>
<dd>Especifica la llave pública GPG con que se firmará el paquete.</dd>
<dt><tt class="docutils literal"><span class="pre">-tc</span></tt></dt>
<dd>Limpia el directorio base de los residuos de la construcción del paquete.</dd>
<dt><tt class="docutils literal"><span class="pre">--git-tag</span></tt></dt>
<dd>Crea una etiqueta que agrupa todos los commits de una determinada versión.</dd>
<dt><tt class="docutils literal"><span class="pre">-jN</span></tt></dt>
<dd>Permite utilizar un número N de hilos para ejecutar el proceso. Se recomienda que N sea el número de procesadores más uno.</dd>
</dl>
<p>Si el proceso culmina satisfactoriamente, correrá lintian para indicarnos si hay alguna discrepancia con las normas de empaquetamiento de debian.</p>
<p>Si el proceso se interrumpe, es una buena práctica crear el tag para evitar errores al correr git-dch en el próximo ciclo. Ejecuta <tt class="docutils literal"><span class="pre">gitbuildpackage</span> <span class="pre">--git-tag-only</span></tt> para asignar el tag sin volver a intentar construir el paquete.</p>
</div>
<div class="section" id="hoja-resumen-cheat-sheet-del-flujo-de-trabajo">
<h3>Hoja Resumen (cheat sheet) del flujo de trabajo<a class="headerlink" href="#hoja-resumen-cheat-sheet-del-flujo-de-trabajo" title="Enlazar permanentemente con este título">¶</a></h3>
<div class="highlight-python"><pre>git add .
git commit --all
git-dch --release --auto --id-length=7 --full
(directorio renombrado)
cd ../nuevo-directorio/
git commit --all
git checkout upstream
git merge master
git checkout master
git push origin master upstream
dh_make --createorig --cdbs --copyright &lt;licencia&gt; --email &lt;correo&gt;
cd ..
(para crear las fuentes formato 1.0)
dpkg-source --format="1.0" -i.git/ -I.git -b nuevo-directorio
cd nuevo-directorio
git push gitorious master upstream
git-buildpackage -k&lt;llave&gt; -tc --git-tag -jN</pre>
</div>
<p>¡Feliz Empaquetado!</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h3><a href="index.html">Contenidos</a></h3>
            <ul>
<li><a class="reference external" href="#"><strong>Manual para el Desarrollador</strong></a><ul>
<li><a class="reference external" href="#sobre-el-ciclo-de-desarrollo-de-canaima"><strong>Sobre el Ciclo de Desarrollo de Canaima</strong></a><ul>
<li><a class="reference external" href="#quienes-son-los-actores">¿Quienes son los actores?</a></li>
<li><a class="reference external" href="#cocinando-una-nueva-version-de-canaima-gnu-linux">Cocinando una nueva versión de Canaima GNU/Linux</a></li>
<li><a class="reference external" href="#etapas-de-desarrollo">Etapas de Desarrollo</a></li>
</ul>
</li>
<li><a class="reference external" href="#versionando-con-git"><strong>Versionando con GIT</strong></a><ul>
<li><a class="reference external" href="#por-que-necesito-versionamiento">¿Por qué necesito versionamiento?</a></li>
<li><a class="reference external" href="#y-por-que-git">¿Y por qué GIT?</a></li>
<li><a class="reference external" href="#como-uso-git">¿Cómo uso GIT?</a></li>
<li><a class="reference external" href="#uso-de-un-repositorio-en-linea">Uso de un repositorio en línea</a></li>
<li><a class="reference external" href="#comenzando-a-trabajar">Comenzando a trabajar</a></li>
<li><a class="reference external" href="#programacion-colaborativa">Programación Colaborativa</a></li>
</ul>
</li>
<li><a class="reference external" href="#empaquetando-con-git-buildpackage"><strong>Empaquetando con git-buildpackage</strong></a><ul>
<li><a class="reference external" href="#terminos-fundamentales">Términos Fundamentales</a></li>
<li><a class="reference external" href="#empezando">Empezando</a></li>
<li><a class="reference external" href="#debianizando-el-codigo-fuente">Debianizando el código fuente</a></li>
<li><a class="reference external" href="#realizar-cambios-al-codigo-fuente">Realizar cambios al código fuente</a></li>
<li><a class="reference external" href="#versionar-los-cambios">Versionar los cambios</a></li>
<li><a class="reference external" href="#generar-el-paquete-fuente">Generar el paquete fuente</a></li>
<li><a class="reference external" href="#publicar-los-cambios">Publicar los cambios</a></li>
<li><a class="reference external" href="#generar-el-paquete-binario">Generar el paquete binario</a></li>
<li><a class="reference external" href="#hoja-resumen-cheat-sheet-del-flujo-de-trabajo">Hoja Resumen (cheat sheet) del flujo de trabajo</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            <h4>Tema anterior</h4>
            <p class="topless"><a href="man-canaima-desarrollador.html"
                                  title="Capítulo anterior"><strong>CANAIMA-DESARROLLADOR</strong></a></p>
            <h4>Próximo tema</h4>
            <p class="topless"><a href="guia-referencia.html"
                                  title="Próximo capítulo"><strong>Guía de Referencia para el Desarrollador</strong></a></p>
            <h3>Esta página</h3>
            <ul class="this-page-menu">
              <li><a href="_sources/manual-desarrollador.txt"
                     rel="nofollow">Enseñar el código</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Búsqueda rápida</h3>
              <form class="search" action="search.html" method="get">
                <input type="text" name="q" size="18" />
                <input type="submit" value="Ir a" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navegación</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="Índice General"
             >índice</a></li>
        <li class="right" >
          <a href="guia-referencia.html" title="Guía de Referencia para el Desarrollador"
             >siguiente</a> |</li>
        <li class="right" >
          <a href="man-canaima-desarrollador.html" title="CANAIMA-DESARROLLADOR"
             >anterior</a> |</li>
        <li><a href="index.html">Manual del Desarrollador para Canaima GNU/Linux</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
      &copy; Copyright 2011, Equipo de Desarrollo de Canaima GNU/Linux.
      Creado con <a href="http://sphinx.pocoo.org/">Sphinx</a> 0.6.6.
    </div>
  </body>
</html>